Crayola=SC.Application.create({store:SC.Store.create().from("Crayola.FixturesDataSource")});Crayola.statechart=SC.Statechart.create({autoInitStatechart:NO,rootState:SC.State.design({initialSubstate:"ready",ready:SC.State.plugin("Crayola.ReadyState")})});Crayola.pane=SC.Pane.create({childViews:["colors"],classNames:["app"],defaultResponder:"Crayola.statechart",colors:SC.TemplateView.design({templateName:"color"})});SC.ready(function(){Crayola.statechart.initStatechart()});if(typeof CHANCE_SLICES==="undefined"){var CHANCE_SLICES=[]}CHANCE_SLICES=CHANCE_SLICES.concat([]);Crayola.colorsController=SC.ArrayController.create({});Crayola.FixturesDataSource=SC.FixturesDataSource.extend({simulateRemoteResponse:YES,latency:250});Crayola.Color=SC.Record.extend({name:SC.Record.attr(String),color:SC.Record.attr(String)});SC.TEMPLATES.color=SC.Handlebars.compile('<h1>Colors</h1>\n{{#collection Crayola.ColorsCollectionView contentBinding="Crayola.colorsController" tagName="div" }}\n  <font {{bindAttr color="content.color"}}>{{content.name}} {{content.color}}</font>\n{{/collection}}');SC.TEMPLATES.crayola=SC.Handlebars.compile("<h1>Welcome to SproutCore!</h1>\n");Crayola.ReadyState=SC.State.extend({initialSubstate:"loading",enterState:function(){Crayola.pane.append()},exitState:function(){Crayola.pane.remove()},loading:SC.State.design({_loaded:0,_total:0,enterState:function(){this._loaded=0;this._total=1;this._loadColors()},exitState:function(){},dataLoaded:function(){this._loaded++;if(this._loaded===this._total){this.get("statechart").sendAction("gotoNone")}},_loadColors:function(){var c=SC.Query.local(Crayola.Color),b=Crayola.store.find(c);b.addObserver("status",this,function a(){if(b.get("status")===SC.Record.READY_CLEAN){b.removeObserver("status",this,a);console.log("data length",b.get("length"));Crayola.colorsController.set("content",b);this.get("statechart").invokeStateMethod("dataLoaded")}});b.notifyPropertyChange("status")}}),none:SC.State.design({initialSubstate:"none",enterState:function(){console.log("Application ready");console.log("Crayola.colorsController.content.length",Crayola.colorsController.content.get("length"))},none:SC.State}),gotoNone:function(){this.gotoState("ready.none");return YES}});Crayola.ColorsCollectionView=SC.TemplateCollectionView.extend({itemView:SC.TemplateView.extend({classNames:["color"],mouseEntered:function(a){document.bgColor=this.content.get("color")},mouseExited:function(a){document.bgColor="ffffff"},mouseDown:function(a){window.alert("You clicked on "+this.content.get("name")+" "+this.content.get("color"))}})});